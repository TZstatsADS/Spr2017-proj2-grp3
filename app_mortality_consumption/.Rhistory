m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, y=~avg_death_percentage) %>%
add_markers(showlegend = FALSE) %>%
add_lines(y = ~fitted(loess(avg_death_percentage~smoker_percentage)),
line = list(color = 'rgba(7, 164, 181, 1)'),
name = "Loess Smoother") %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, y=~avg_death_percentage) %>%
add_markers(y = ~avg_death_percentage, text = rownames(mort_conspDF), showlegend = FALSE) %>%
add_lines(y = ~fitted(loess(avg_death_percentage~smoker_percentage)),
line = list(color = 'rgba(7, 164, 181, 1)'),
name = "Loess Smoother") %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
p <- plot_ly(mort_conspDF,x=~smoker_percentage, y=~avg_death_percentage, color=I("black")) %>%
add_markers(y = ~avg_death_percentage, text = rownames(mort_conspDF), showlegend = FALSE) %>%
add_lines(y = ~fitted(loess(avg_death_percentage~smoker_percentage)),
line = list(color = '#07A4B5'),
name = "Loess Smoother") %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, y=~avg_death_percentage, color=I("black")) %>%
add_markers(y = ~avg_death_percentage, text = rownames(mort_conspDF), showlegend = FALSE) %>%
add_lines(y = ~fitted(loess(avg_death_percentage~smoker_percentage)),
line = list(color = '#07A4B5'),
name = "Loess Smoother") %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, y=~avg_death_percentage, color=I("black")) %>%
add_markers(y = ~avg_death_percentage, text = mort_conspDF$states, showlegend = FALSE) %>%
add_lines(y = ~fitted(loess(avg_death_percentage~smoker_percentage)),
line = list(color = '#07A4B5'),
name = "Loess Smoother") %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, y=~avg_death_percentage, color=I("black")) %>%
add_markers(y = ~avg_death_percentage, text = mort_conspDF$states, showlegend = FALSE) %>%
add_lines(y = ~fitted(loess(avg_death_percentage~smoker_percentage)),
line = list(color = '#07A4B5'),
name = "Loess Smoother",
showlegend = TRUE) %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, y=~avg_death_percentage, color=I("navy blue")) %>%
add_markers(y = ~avg_death_percentage, text = mort_conspDF$states, showlegend = FALSE) %>%
add_lines(y = ~fitted(loess(avg_death_percentage~smoker_percentage)),
line = list(color = '#07A4B5'),
name = "Loess Smoother",
showlegend = TRUE) %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, y=~avg_death_percentage, color=I("sky blue")) %>%
add_markers(y = ~avg_death_percentage, text = mort_conspDF$states, showlegend = FALSE) %>%
add_lines(y = ~fitted(loess(avg_death_percentage~smoker_percentage)),
line = list(color = '#07A4B5'),
name = "Loess Smoother",
showlegend = TRUE) %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, y=~avg_death_percentage, color=I("sky blue")) %>%
add_markers(y = ~avg_death_percentage, text = mort_conspDF$states, showlegend = FALSE) %>%
add_lines(y = ~fitted(loess(avg_death_percentage~smoker_percentage)),
line = list(color = '#07A4B5'),
name = "Loess Smoother",
showlegend = TRUE) %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = "navy blue"),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, y=~avg_death_percentage, color=I("sky blue")) %>%
add_markers(y = ~avg_death_percentage, text = mort_conspDF$states, showlegend = FALSE) %>%
add_lines(y = ~fitted(loess(avg_death_percentage~smoker_percentage)),
line = list(color = 'navy blue'),
name = "Loess Smoother",
showlegend = TRUE) %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, y=~avg_death_percentage, color=I("black")) %>%
add_markers(y = ~avg_death_percentage, text = mort_conspDF$states, showlegend = FALSE) %>%
add_lines(y = ~fitted(loess(avg_death_percentage~smoker_percentage)),
line = list(color = 'navy blue'),
name = "Loess Smoother",
showlegend = TRUE) %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, y=~avg_death_percentage, color=I("black")) %>%
add_markers(y = ~avg_death_percentage, text = mort_conspDF$states, showlegend = FALSE) %>%
add_lines(y = ~fitted(loess(avg_death_percentage~smoker_percentage)),
line = list(color = 'navy blue'),
name = "Loess Smoother",
showlegend = TRUE) %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, y=~avg_death_percentage, color=I("black")) %>%
add_markers(y = ~avg_death_percentage, text = mort_conspDF$states, showlegend = FALSE) %>%
add_lines(y = ~fitted(m),
line = list(color = 'navy blue'),
name = "Loess Smoother",
showlegend = TRUE) %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, y=~avg_death_percentage, color=I("black")) %>%
add_markers(y = ~avg_death_percentage, text = mort_conspDF$states, showlegend = FALSE) %>%
add_lines(y = ~fitted(m),
line = list(color = 'black'),
name = "Loess Smoother",
showlegend = TRUE) %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, color=I("black")) %>%
add_markers(y = ~avg_death_percentage, text = mort_conspDF$states, showlegend = FALSE) %>%
add_lines(y = ~fitted(m),
line = list(color = 'black'),
name = "Loess Smoother",
showlegend = TRUE) %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
library(plotly)
library(broom)
m <- loess(mpg ~ disp, data = mtcars)
p <- plot_ly(mtcars, x = ~disp, color = I("black")) %>%
add_markers(y = ~mpg, text = rownames(mtcars), showlegend = FALSE) %>%
add_lines(y = ~fitted(loess(mpg ~ disp)),
line = list(color = 'rgba(7, 164, 181, 1)'),
name = "Loess Smoother") %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Displacement (cu.in.)'),
yaxis = list(title = 'Miles/(US) gallon'),
legend = list(x = 0.80, y = 0.90))
library(plotly)
library(broom)
m <- loess(mpg ~ disp, data = mtcars)
p <- plot_ly(mtcars, x = ~disp, color = I("black")) %>%
add_markers(y = ~mpg, text = rownames(mtcars), showlegend = FALSE) %>%
add_lines(y = ~fitted(loess(mpg ~ disp)),
line = list(color = 'rgba(7, 164, 181, 1)'),
name = "Loess Smoother") %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Displacement (cu.in.)'),
yaxis = list(title = 'Miles/(US) gallon'),
legend = list(x = 0.80, y = 0.90))
p
library(plotly)
library(broom)
m <- loess(mpg ~ disp, data = mtcars)
p <- plot_ly(mtcars, x = ~disp, color = I("black")) %>%
add_markers(y = ~mpg, text = rownames(mtcars), showlegend = FALSE) %>%
add_lines(y = ~fitted(m),
line = list(color = 'rgba(7, 164, 181, 1)'),
name = "Loess Smoother") %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Displacement (cu.in.)'),
yaxis = list(title = 'Miles/(US) gallon'),
legend = list(x = 0.80, y = 0.90))
p
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, color=I("black")) %>%
add_markers(y = ~avg_death_percentage, text = mort_conspDF$states, showlegend = FALSE) %>%
add_lines(y = ~fitted(m),
line = list(color = 'black'),
name = "Loess Smoother",
showlegend = TRUE) %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, color=I("black")) %>%
add_markers(y = ~avg_death_percentage, text = mort_conspDF$states, showlegend = FALSE) %>%
add_lines(y = ~fitted(m),
line = list(color = 'black'),
name = "Loess Smoother",
showlegend = TRUE) %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, color=I("black")) %>%
add_markers(y = ~avg_death_percentage, text = mort_conspDF$states, showlegend = FALSE) %>%
add_lines(y = ~fitted(m),
line = list(color = 'black'),
name = "Loess Smoother",
showlegend = TRUE) %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, color=I("black")) %>%
add_markers(y = ~avg_death_percentage, text = mort_conspDF$states, showlegend = FALSE) %>%
add_trace(y = ~fitted(m),
line = list(color = 'black'),
name = "Loess Smoother",
showlegend = TRUE) %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
library(plotly)
library(broom)
m <- loess(mpg ~ disp, data = mtcars)
p <- plot_ly(mtcars, x = ~disp, color = I("black")) %>%
add_markers(y = ~mpg, text = rownames(mtcars), showlegend = FALSE) %>%
add_lines(y = ~fitted(m),
line = list(color = 'rgba(7, 164, 181, 1)'),
name = "Loess Smoother") %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Displacement (cu.in.)'),
yaxis = list(title = 'Miles/(US) gallon'),
legend = list(x = 0.80, y = 0.90))
p
head(mort_conspDF)
head(mtcars)
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, color=I("black")) %>%
add_markers(y = ~avg_death_percentage, text = mort_conspDF$states, showlegend = FALSE) %>%
add_lines(y = ~fitted(m),
line = list(color = 'rgba(7, 164, 181, 1)'),
name = "Loess Smoother",
showlegend = TRUE) %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
library(plotly)
library(broom)
m <- loess(mpg ~ disp, data = mtcars)
p <- plot_ly(mtcars, x = ~disp, color = I("black")) %>%
add_markers(y = ~mpg, text = rownames(mtcars), showlegend = FALSE) %>%
add_lines(y = ~fitted(m),
line = list(color = 'rgba(7, 164, 181, 1)'),
name = "Loess Smoother") %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Displacement (cu.in.)'),
yaxis = list(title = 'Miles/(US) gallon'),
legend = list(x = 0.80, y = 0.90))
p
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, color=I("black")) %>%
add_markers(y = ~avg_death_percentage, text = mort_conspDF$states, showlegend = FALSE) %>%
add_lines(y = ~fitted(m),
line = list(color = 'rgba(7, 164, 181, 1)'),
name = "Loess Smoother") %>%
add_ribbons(data = augment(m),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
m
fitted(m)
runApp()
runApp()
runApp('E:/statistics/applied data science/Project2/Spr2017-proj2-grp3/app_gender_mortality')
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
mortality <- read.csv("../output/states mortality.csv") %>%
filter(class=="Overall") %>%
rename(death_percentage = ratio) %>%
group_by(states) %>%
mutate(avg_death_percentage = mean(death_percentage, na.rm=TRUE)) %>%
distinct(year,avg_death_percentage)
consumption <- read.csv("../output/smokers_proportion.csv") %>%
filter(YEAR != 2015, Gender=="Overall") %>%
rename(year=YEAR, states=LocationDesc, smoker_percentage = Data_Value)
mortality_consumption <- left_join(mortality, consumption) %>% select(year, states, avg_death_percentage, smoker_percentage)
mort_conspDF <- filter(mortality_consumption, year == 2010)
m <- loess(avg_death_percentage~smoker_percentage, data = mort_conspDF)
p <- plot_ly(mort_conspDF,x=~smoker_percentage, color=I("black")) %>%
add_markers(y = ~avg_death_percentage, text = mort_conspDF$states, showlegend = FALSE) %>%
add_lines(y = ~fitted(m),
line = list(color = 'rgba(7, 164, 181, 1)'),
name = "Loess Smoother") %>%
add_ribbons(data = augment(loess(avg_death_percentage~smoker_percentage)),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
p <- plot_ly(mort_conspDF,x=~smoker_percentage, color=I("black")) %>%
add_markers(y = ~avg_death_percentage, text = mort_conspDF$states, showlegend = FALSE) %>%
add_lines(y = ~fitted(m),
line = list(color = 'rgba(7, 164, 181, 1)'),
name = "Loess Smoother") %>%
add_ribbons(data = augment(loess(avg_death_percentage~smoker_percentage,data = mort_conspDF)),
ymin = ~.fitted - 1.96 * .se.fit,
ymax = ~.fitted + 1.96 * .se.fit,
line = list(color = 'rgba(7, 164, 181, 0.05)'),
fillcolor = 'rgba(7, 164, 181, 0.2)',
name = "Standard Error") %>%
layout(xaxis = list(title = 'Smoker Proportion'),
yaxis = list(title = 'Death Percentage'),
legend = list(x = 0.80, y = 0.90),
title="Death-Consumption Relationship of All States")
p
runApp()
